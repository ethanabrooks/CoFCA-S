#!/usr/bin/env zsh

new_config="/tmp/config.yaml"
run_id=$(echo $1 | sed 's/ethanabrooks\/[^\/]*\/\(.*\)/\1/')
${0:a:h}/fix_config $run_id
${0:a:h}/fix_config $run_id > $new_config

load=$(${0:a:h}/search $run_id checkpoint.pt)
cmd="python $2 --config-path=/tmp load_path=$(pwd)/$load use_wandb=False ${@:3}"
echo "$cmd\n"
eval "$cmd"
