* should c be attention-weighted?
* make f recurrent